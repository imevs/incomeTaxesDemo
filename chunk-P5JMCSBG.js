import{a as Q}from"./chunk-DDMCPOCP.js";import{Aa as C,Ea as h,Fa as y,Ga as g,Ha as c,Ia as p,Ja as b,La as R,Na as v,Oa as _,Pa as M,Qa as D,Ra as u,Ua as I,V as d,Xa as S,Ya as x,Za as k,bc as m,ec as N,fc as P,jc as T,ka as l,kc as L,lc as B,oc as E,pc as w,qa as f,qc as O,rc as F,uc as W}from"./chunk-5WLU4PN2.js";function V(i,a){if(i&1&&(c(0,"option",2),u(1),p()),i&2){let e=a.$implicit;v("value",e.options.year+e.options.country),l(),I("",e.options.country," - ",e.options.year,"")}}var A=class i{chartTaxes;calculationList=[];selectedReport="";barChartOptions={scales:{x:{stacked:!0},y:{stacked:!0,beginAtZero:!0,max:55,ticks:{callback:(a,e,t)=>a+"%"}}},animation:{delay:200,duration:0},plugins:{legend:{display:!0,align:"end"},datalabels:{display:function(a){let e=a.dataset.data?.[a.dataIndex];return typeof e=="number"&&e>1},formatter:a=>a,rotation:90}}};taxChartData={labels:[],datasets:[]};generateBarDataset(a){let e=a;if(!e)return[];let t=e.options.country,o=e.reports,r="("+e.options.country+"/"+e.options.year+")";return["effectiveRates.socialTaxByEmployer","effectiveRates.socialTaxByWorker","effectiveRates.income","effectiveRates.solidarityTaxesRate"].map(n=>({data:o.map(s=>n.includes("effectiveRates")?s.effectiveRates[n.split(".")[1]]:n.includes("rates")?s.rates[n.split(".")[1]]:s[n]*O[t].exchangeRate),stack:r,label:Q.find(s=>s.key===n)?.name+" "+r}))}ngOnChanges(a){!this.selectedReport&&this.calculationList[0]&&(this.selectedReport=this.calculationList[0].options.year+this.calculationList[0].options.country);let e=this.calculationList.find(t=>t.options.year+t.options.country===this.selectedReport);e&&(this.taxChartData={labels:F.map(t=>W(t,0,"EUR")),datasets:[...this.generateBarDataset(e)]},this.chartTaxes?.update())}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=f({type:i,selectors:[["income-parts-chart"]],viewQuery:function(e,t){if(e&1&&_(m,5),e&2){let o;M(o=D())&&(t.chartTaxes=o.first)}},inputs:{calculationList:"calculationList"},features:[d],decls:9,vars:4,consts:[["for","selectedReport"],["id","selectedReport",3,"ngModelChange","ngModel"],[3,"value"],["baseChart","",3,"data","options","type"]],template:function(e,t){e&1&&(c(0,"h2"),u(1,"Composition of effective rates from full costs"),p(),c(2,"div")(3,"label",0),u(4,"Select report: "),p(),c(5,"select",1),k("ngModelChange",function(r){return x(t.selectedReport,r)||(t.selectedReport=r),r}),R("ngModelChange",function(){return t.ngOnChanges({})}),y(6,V,2,3,"option",2,h),p()(),b(8,"canvas",3)),e&2&&(l(5),S("ngModel",t.selectedReport),l(),g(t.calculationList),l(2),C("data",t.taxChartData)("options",t.barChartOptions)("type","bar"))},dependencies:[m,w,L,B,T,N,E,P],encapsulation:2})};export{A as IncomePartsChartComponent};
